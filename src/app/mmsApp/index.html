<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">

    <!-- Fonts -->

    <link href='http://fonts.googleapis.com/css?family=Titillium+Web:400,400italic,600,600italic,700,700italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="/extlib/bower_components/font-awesome/css/font-awesome.min.css">

    <!-- Include CSS library dependencies -->
    <link type="text/css" rel="stylesheet" href="/extlib/bower_components/bootstrap/dist/css/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="/extlib/bower_components/jquery-ui/themes/black-tie/jquery-ui.css">

    <link type="text/css" rel="stylesheet" href="/extlib/bower_components/angular-material/angular-material.min.css" rel="stylesheet">

    <link rel="stylesheet" href="/extlib/bower_components/jscrollpane/style/jquery.jscrollpane.css">

    <link rel="stylesheet" href="/extlib/bower_components/angular-socialshare/angular-socialshare.min.css">

    <link rel="stylesheet" href="/extlib/bower_components/angucomplete/angucomplete.css">

    <!-- Include CSS isis-ui-components -->
    <link type="text/css" rel="stylesheet" href="/extlib/bower_components/isis-ui-components/dist/isis-ui-components.css">

    <!-- Include other cyphy-components -->
    <link type="text/css" rel="stylesheet" href="/extlib/bower_components/angular-growl/build/angular-growl.min.css">
    <link type="text/css" rel="stylesheet" href="/extlib/dist/cyphy-components.css">

    <link type="text/css" rel="stylesheet" href="/extlib/dist/mmsApp-app.css">

    <link type="text/css" rel="stylesheet" href="/extlib/bower_components/angular-pan-zoom/bin/panzoomwidget.css">

    <title>Metamorphosys</title>
</head>
<body class="mms-app ng-cloak" data-ng-controller="AppController">
<div growl></div>
<div data-ng-controller="MainNavigatorController"
     class="main-navigator-container">
    <dropdown-navigator data-navigator="navigator"></dropdown-navigator>
</div>
<div ui-view class="main-view-container" resize-to-window height-is-less-with="51"></div>

<busy-cover>
    <div ui-view="onCover"></div>
</busy-cover>

<header-buttons></header-buttons>

<div class="processing-cover"
     ng-if="processing"
        ></div>

<!-- Include library dependencies -->
<script src="/extlib/bower_components/jquery/dist/jquery.min.js"></script>
<!--<script src="/extlib/bower_components/jquery-mobile-bower/js/jquery.mobile-1.4.2.min.js"></script>-->

<script src="/extlib/bower_components/hammerjs/hammer.js"></script>
<script src="/extlib/bower_components/angular/angular.js"></script>
<script src="/extlib/bower_components/angular-touch/angular-touch.js"></script>
<script src="/extlib/bower_components/angular-animate/angular-animate.min.js"></script>
<script src="/extlib/bower_components/angular-aria/angular-aria.min.js"></script>
<script src="/extlib/bower_components/angular-material/angular-material.min.js"></script>
<script src="/extlib/bower_components/angular-cookies/angular-cookies.min.js"></script>
<script src="/extlib/bower_components/angucomplete-alt/dist/angucomplete-alt.min.js"></script>
<script src="/extlib/bower_components/angular-socialshare/angular-socialshare.min.js"></script>

<script src="/extlib/bower_components/angular-ui-router/release/angular-ui-router.min.js"></script>
<script src="/extlib/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/extlib/bower_components//angular-bootstrap/ui-bootstrap-tpls.js"></script>
<script src="/extlib/bower_components/angular-ui-utils/ui-utils.min.js"></script>
<script src="/extlib/bower_components/ng-grid/build/ng-grid.min.js"></script>
<script src="/extlib/bower_components/angular-ui-utils/ui-utils.min.js"></script>

<!-- Panzoom stuff -->
<script src="/extlib/bower_components/hamsterjs/hamster.js"></script>
<script src="/extlib/bower_components/angular-panhandler/dist/angular-panhandler.min.js"></script>
<script src="/extlib/bower_components/angular-mousewheel/mousewheel.js"></script>
<script src="/extlib/bower_components/angular-pan-zoom/bin/panzoom.js"></script>

<!-- jScrollPane stuff -->
<script src="/extlib/bower_components/jscrollpane/script/jquery.mousewheel.js"></script>
<script src="/extlib/bower_components/jscrollpane/script/jquery.jscrollpane.min.js"></script>


<!-- Include WebGME libraries -->
<!--  client -->
<script src="/extlib/node_modules/webgme/dist/webgme.classes.build.js"></script>
<script src="/extlib/dist/webcyphy.plugins.build.js"></script>
<!--  angular module services-->
<!--<script src="/extlib/node_modules/webgme/src/client/js/services/gme-services.js"></script>-->
<script src="/extlib/node_modules/ng-gme/dist/ng-gme.js"></script>

<!-- Include isis-ui-components -->
<script src="/extlib/bower_components/isis-ui-components/dist/isis-ui-components.js"></script>
<script src="/extlib/bower_components/isis-ui-components/dist/isis-ui-components-templates.js"></script>

<!-- Include cyphy-components -->
<script src="/extlib/dist/cyphy-components.js"></script>
<script src="/extlib/dist/cyphy-components-templates.js"></script>

<!-- Include application -->
<script src="/extlib/dist/mmsApp-app.js"></script>
<script src="/extlib/dist/mmsApp-app-templates.js"></script>

<!-- Social media -->
<script src="http://platform.twitter.com/widgets.js"></script>

<!-- Start the main application -->
<script type="text/javascript">
    var clientLoaded,
            timeout = 5000, // 10 seconds
            waitCounter = 0,
            i,
            success,
            usedClasses = ["Client"],
            interval = 200, // 100 milliseconds interval
            waitForLoadId = setInterval(function () {
                if (window.GME &&
                    window.GME.classes) {
                    // TODO: check for all classes that we use
                    clearInterval(waitForLoadId);
                    success = true;

                    for (i = 0; i < usedClasses.length; i += 1) {
                        if (window.GME.classes.hasOwnProperty(usedClasses[i])) {
                            console.log('WebGME ' + usedClasses[i] + ' is available.');
                        } else {
                            console.error('WebGME ' + usedClasses[i] + ' was not found.');
                            success = false;
                        }
                    }

                    if (success) {
                        console.log('WebGME client library is ready to use.');
                        clientLoaded();
                    }
                } else {
                    console.log('Waiting for WebGME client library to load.');
                    waitCounter += 1;
                    if (waitCounter >= timeout / interval) {
                        clearInterval(waitForLoadId);
                        console.error('WebGME client library was not loaded within a reasonable time. (' + (timeout / 1000) + ' s)');
                    }
                }
            }, interval);

    clientLoaded = function () {
        // main entry point of the app.js
        // once the webgme Client is loaded and ready we can use it.

        angular.bootstrap(document, ['CyPhyApp']);
    };
</script>

</body>
</html>
